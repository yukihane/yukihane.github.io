<!DOCTYPE html>
<html><head lang="ja">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>クッキーの挙動は Same Origin Policy に従う…わけではない - 発火後忘失</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="
次のQiitaのコメントを見て、そうなんだ、となりました:




Auth TokenをlocalStorageに入れようが、cookieに入れようがどっちもXSS危険性には無防備（同ドメイン内なら …​）


" />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="https://yukihane.github.io/blog/202007/19/cookies-and-same-origin-policy/">
  <meta property="og:site_name" content="発火後忘失">
  <meta property="og:title" content="クッキーの挙動は Same Origin Policy に従う…わけではない">
  <meta property="og:description" content="次のQiitaのコメントを見て、そうなんだ、となりました:
Auth TokenをlocalStorageに入れようが、cookieに入れようがどっちもXSS危険性には無防備（同ドメイン内なら …​）">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2020-07-19T11:59:29+00:00">
    <meta property="article:modified_time" content="2020-07-19T11:59:29+00:00">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="クッキーの挙動は Same Origin Policy に従う…わけではない">
  <meta name="twitter:description" content="次のQiitaのコメントを見て、そうなんだ、となりました:
Auth TokenをlocalStorageに入れようが、cookieに入れようがどっちもXSS危険性には無防備（同ドメイン内なら …​）">

        <link href="https://yukihane.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://yukihane.github.io/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://yukihane.github.io/css/dark.50b57e12d401420df23965fed157368aba37b76df0ecefd0b1ecd4da664f01a0.css"  disabled />
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://yukihane.github.io/">発火後忘失</a>
	</div>
	<nav>
		
		<a href="/blog">Blog</a>
		
		<a href="/docs">Docs</a>
		
		<a href="/tags">Tags</a>
		
		<a href="https://github.com/yukihane/resume/blob/main/README.md">Resume</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#sun" />
</svg></span>
		<script src="https://yukihane.github.io/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
  <article>
    <div class="post-container">
      
      <div class="post-content">
        <div class="title">
          <h1 class="title">クッキーの挙動は Same Origin Policy に従う…わけではない</h1>
          <div class="meta">Posted on 2020/07/19</div>
        </div>
        
        <section class="body">
          <div class="paragraph">
<p>次のQiitaのコメントを見て、そうなんだ、となりました:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://qiita.com/github0013@github/items/e57c452de28f3918bf05#comment-4df8a971cd5c8c2d0673">Auth TokenをlocalStorageに入れようが、cookieに入れようがどっちもXSS危険性には無防備（同ドメイン内なら …​）</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>根拠を探してみたところ、同じくQiitaの記事</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://qiita.com/kubocchi/items/020352173d014cbf5332#%E5%95%8F2">君はできるかな？Cookie ＆ Same Origin Policyセキュリティークイズ4問</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>の出典として <a href="https://tools.ietf.org/html/rfc6265">RFC6265 HTTP State Management Mechanism</a>が挙げられており、そちらのドキュメントの冒頭にバッチリ書いてありました:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>(前略)Similarly, cookies for a given host are shared across all the ports on that host, even though the usual &#34;same-origin policy&#34; used by web browsers isolates content retrieved via different ports.</p>
</div>
</blockquote>
<div class="attribution">
— <a href="https://tools.ietf.org/html/rfc6265#section-1">1. Introduction</a>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Cookies do not provide isolation by port.  If a cookie is readable by
   a service running on one port, the cookie is also readable by a
   service running on another port of the same server.  If a cookie is
   writable by a service on one port, the cookie is also writable by a
   service running on another port of the same server.  For this reason,
   servers SHOULD NOT both run mutually distrusting services on
   different ports of the same host and use cookies to store security-
   sensitive information.</p>
</div>
</blockquote>
<div class="attribution">
— <a href="https://tools.ietf.org/html/rfc6265#section-8.5">8.5. Weak Confidentiality</a>
</div>
</div>
<div class="paragraph">
<p>ちなみに後続の文章ではスキーマ(<code>http</code> とか)が違っても送信されるよ、と書いてありまして、そういやその問題を抑制する方策のひとつとして <code>secure</code> があるのだな、と。</p>
</div>
<div class="paragraph">
<p>逆に言えば、 <code>secure</code> 属性みたいなのが必要ってことはcookiesはsame-origin-policyに従っているわけではないのだな、という推測が可能ですね。</p>
</div>

        </section>
        <div class="post-tags">
          
          
          
        </div>
      </div>

      
      
    </div>

    </article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/yukihane" rel="me" title="GitHub"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github" />
</svg></a><a class="border"></a></div>
  <div class="footer-info">
    2025  &amp;copy;{year}, All Rights Reserved |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-E9J8FN5B4Q"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-E9J8FN5B4Q');
        }
      </script>

</div>
    </body>
</html>
