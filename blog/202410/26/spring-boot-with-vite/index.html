<!DOCTYPE html>
<html><head lang="ja">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Spring Boot 開発で SASS や TypeScript を利用するための設定(Vite) - 発火後忘失</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="はじめに
次のエントリーで、Spring Boot &amp; Thymeleaf な開発時に TypeScript を利用する設定を書きました。

Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle)
Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle) - Polyfill も必要とする場合

今回は Spring Boot &amp; Thymeleaf な開発で、もうちょっとちゃんとモダンなフロントエンド開発環境を統合する手順です。" />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="https://yukihane.github.io/blog/202410/26/spring-boot-with-vite/">
  <meta property="og:site_name" content="発火後忘失">
  <meta property="og:title" content="Spring Boot 開発で SASS や TypeScript を利用するための設定(Vite)">
  <meta property="og:description" content="はじめに 次のエントリーで、Spring Boot &amp; Thymeleaf な開発時に TypeScript を利用する設定を書きました。
Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle) Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle) - Polyfill も必要とする場合 今回は Spring Boot &amp; Thymeleaf な開発で、もうちょっとちゃんとモダンなフロントエンド開発環境を統合する手順です。">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-10-26T01:49:44+09:00">
    <meta property="article:modified_time" content="2024-10-26T01:49:44+09:00">
    <meta property="article:tag" content="Spring-Boot">
    <meta property="article:tag" content="Vite">
    <meta property="article:tag" content="Frontend">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Spring Boot 開発で SASS や TypeScript を利用するための設定(Vite)">
  <meta name="twitter:description" content="はじめに 次のエントリーで、Spring Boot &amp; Thymeleaf な開発時に TypeScript を利用する設定を書きました。
Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle) Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle) - Polyfill も必要とする場合 今回は Spring Boot &amp; Thymeleaf な開発で、もうちょっとちゃんとモダンなフロントエンド開発環境を統合する手順です。">

        <link href="https://yukihane.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://yukihane.github.io/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://yukihane.github.io/css/dark.50b57e12d401420df23965fed157368aba37b76df0ecefd0b1ecd4da664f01a0.css"  disabled />
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://yukihane.github.io/">発火後忘失</a>
	</div>
	<nav>
		
		<a href="/blog">Blog</a>
		
		<a href="/docs">Docs</a>
		
		<a href="/tags">Tags</a>
		
		<a href="https://github.com/yukihane">GitHub</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#sun" />
</svg></span>
		<script src="https://yukihane.github.io/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
  <article>
    <div class="post-container">
      
      <div class="post-content">
        <div class="title">
          <h1 class="title">Spring Boot 開発で SASS や TypeScript を利用するための設定(Vite)</h1>
          <div class="meta">Posted on 2024/10/26</div>
        </div>
        
        <section class="body">
          <h2 id="はじめに">はじめに</h2>
<p>次のエントリーで、Spring Boot &amp; Thymeleaf な開発時に TypeScript を利用する設定を書きました。</p>
<ul>
<li><a href="/blog/202107/10/spring-boot-with-typescript/">Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle)</a></li>
<li><a href="/blog/202107/11/spring-boot-with-babel/">Spring Boot と TypeScript で開発するためのプロジェクト設定(Gradle) - Polyfill も必要とする場合</a></li>
</ul>
<p>今回は Spring Boot &amp; Thymeleaf な開発で、もうちょっとちゃんとモダンなフロントエンド開発環境を統合する手順です。</p>
<p>表題の通り Vite を利用します。</p>
<p>また、<a href="/blog/202410/20/spring-boot-devtools-auto-restart/">こちら</a>に書いた問題があるので spring-boot-devtools には依存しないようにします(代わりに IDE(ここでは IntelliJ IDEA Ultimate を利用しますが、Eclipse など他の IDE でも同じはず)の hot swapping 機能を前提にします)。</p>
<h2 id="本文の要点">本文の要点</h2>
<p>Spring Boot で Thymeleaf(などのテンプレートエンジン) を用いる場合、リソースファイルを <code>templates</code> と <code>static</code> のディレクトリーに分類して配置する必要があります。</p>
<p>Vite の標準処理フローでは、整合性を保ったままこのように 2 つのディレクトリーに assets を配備することはできなさそうなので、 plugins 機構を使ってマニュアルでファイルを移動させることにしました。</p>
<h2 id="実証コード">実証コード</h2>
<ul>
<li><a href="https://github.com/yukihane/hello-java/tree/main/spring/with-vite">https://github.com/yukihane/hello-java/tree/main/spring/with-vite</a></li>
</ul>
<h2 id="手順">手順</h2>
<h3 id="spring-boot-プロジェクト作成">Spring Boot プロジェクト作成</h3>
<p>まず、Spring Boot の環境を整えます。 <a href="https://start.spring.io/">https://start.spring.io/</a> で &ldquo;Spring Web&rdquo;, &ldquo;Thymeleaf&rdquo; を含むプロジェクトを作成し、ローカルに展開します。</p>
<h3 id="vite-プロジェクト作成">Vite プロジェクト作成</h3>
<p>続いて、ここにフロントエンド開発環境を整えます。<br />
Spring Boot プロジェクトディレクトリのルート(<code>gradlew</code> や <code>src</code> ディレクトリがあるところ)で、次のコマンドを実行します:</p>
<pre tabindex="0"><code>npm create vite@latest
</code></pre><p>(<a href="https://vite.dev/guide/#scaffolding-your-first-vite-project">参考</a>)</p>
<p>途中の質問はは次のように回答します:</p>
<ul>
<li>Project name: <strong>thymeleaf</strong>
<ul>
<li>補足: なんでも良いです</li>
</ul>
</li>
<li>Select a framework: <strong>Vanilla</strong></li>
<li>Select a variant: <strong>TypeScript</strong></li>
</ul>
<p>以降、作成した <code>thymeleaf</code> ディレクトリで作業します。</p>
<p>次のコマンドを実行しモジュールをインストールします。</p>
<pre tabindex="0"><code>npm install
</code></pre><h3 id="vite-設定">Vite 設定</h3>
<p>自動生成された <code>index.html</code> と <code>src</code>, <code>public</code> ディレクトリ以下のファイルは不要なので削除します。</p>
<pre tabindex="0"><code>rm -r index.html src/* public/*
</code></pre><p>次に作成するファイルで型を効かせたいので <code>@types/node</code> をインストールしておきます:</p>
<pre tabindex="0"><code>npm install --save-dev `@types/node`
</code></pre><p><code>vite.config.ts</code> ファイルを作成し、次の内容を記述します:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">// 参考: https://ja.vite.dev/config/
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">import</span> <span class="kr">type</span> <span class="p">{</span> <span class="nx">UserConfig</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;vite&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">resolve</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;path&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">promises</span> <span class="kr">as</span> <span class="nx">fs</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;fs&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">build</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">minify</span>: <span class="kt">false</span><span class="p">,</span> <span class="c1">// 今回、わかりやすいようにminifyは実行しないこととしています
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">rollupOptions</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// resouces/templates に入れる html ファイルを列挙する
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">input</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ここに thymeleaf テンプレートファイルを列挙する
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// &#34;hello/index&#34;: &#34;templates/hello/index.html&#34;,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 出力ファイル名にhashを付けないようにする設定
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// https://github.com/vitejs/vite/issues/378#issuecomment-789366197
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">entryFileNames</span><span class="o">:</span> <span class="sb">`vite/[name].js`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">chunkFileNames</span><span class="o">:</span> <span class="sb">`vite/[name].js`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">assetFileNames</span><span class="o">:</span> <span class="sb">`vite/[name].[ext]`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ビルドしたファイルを Spring Boot のリソースディレクトリーに移す
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;move-resources&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">closeBundle</span>: <span class="kt">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">srcTemplates</span> <span class="o">=</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">&#34;dist/templates&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">destTemplates</span> <span class="o">=</span> <span class="nx">resolve</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="nx">__dirname</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;../src/main/resources/templates&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">srcVite</span> <span class="o">=</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">&#34;dist/vite&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">destVite</span> <span class="o">=</span> <span class="nx">resolve</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="nx">__dirname</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;../src/main/resources/static/vite&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">await</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">rm</span><span class="p">(</span><span class="nx">destTemplates</span><span class="p">,</span> <span class="p">{</span> <span class="nx">recursive</span>: <span class="kt">true</span><span class="p">,</span> <span class="nx">force</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="k">await</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">destTemplates</span><span class="p">,</span> <span class="p">{</span> <span class="nx">recursive</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="k">await</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">cp</span><span class="p">(</span><span class="nx">srcTemplates</span><span class="p">,</span> <span class="nx">destTemplates</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">recursive</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">force</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sb">`Moved templates from </span><span class="si">${</span><span class="nx">srcTemplates</span><span class="si">}</span><span class="sb"> to </span><span class="si">${</span><span class="nx">destTemplates</span><span class="si">}</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">          <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="k">await</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">rm</span><span class="p">(</span><span class="nx">destVite</span><span class="p">,</span> <span class="p">{</span> <span class="nx">recursive</span>: <span class="kt">true</span><span class="p">,</span> <span class="nx">force</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="k">await</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">destVite</span><span class="p">,</span> <span class="p">{</span> <span class="nx">recursive</span>: <span class="kt">true</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="k">await</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">cp</span><span class="p">(</span><span class="nx">srcVite</span><span class="p">,</span> <span class="nx">destVite</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">recursive</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">force</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="p">});</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Moved templates from </span><span class="si">${</span><span class="nx">srcVite</span><span class="si">}</span><span class="sb"> to </span><span class="si">${</span><span class="nx">destVite</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Failed to move templates: </span><span class="si">${</span><span class="nx">err</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="nx">satisfies</span> <span class="nx">UserConfig</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ページを作成してみる">ページを作成してみる</h2>
<p>簡単なページを作成してみます。</p>
<p><code>.scss</code> を扱いたいのでモジュールをインストールします:</p>
<pre tabindex="0"><code>npm install --save-dev sass-embedded
</code></pre><p><code>public</code> ディレクトリー(<a href="https://ja.vite.dev/guide/assets#the-public-directory">参考</a>) に画像を作成します。このとき、他の(<code>src</code> 以下の)ファイルと同じように <code>vite</code> ディレクトリに出力されるように <code>public/vite</code> 以下に作成します:</p>
<pre tabindex="0"><code>mkdir -p public/vite/image
# ここでは ImageMagick で画像生成していますが、別に何でも構わないので public/vite/image/hello.png という名前で画像ファイルを保存します
convert -size 300x100 xc:lightblue -gravity center -pointsize 20 -draw &#34;text 0,0 &#39;Hello, World!&#39;&#34; public/vite/image/hello.png
</code></pre><p><code>src</code> ディレクトリーにリソースを作成します:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">// src/hello/main.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&#34;DOMContentLoaded&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Hello, Vite!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scss" data-lang="scss"><span class="line"><span class="cl"><span class="cm">/* src/hello/style.scss */</span>
</span></span><span class="line"><span class="cl"><span class="nt">div</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">.hello</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">border</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="ni">dotted</span> <span class="no">blue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>上記したリソースを参照する Thymeleaf テンプレート(.html)を <code>themplates</code> ディレクトリーに作成します:</p>
<pre tabindex="0"><code>mkdir -p templates/hello
</code></pre><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ja&#34;</span> <span class="na">xmlns:th</span><span class="o">=</span><span class="s">&#34;http://www.thymeleaf.org&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/src/hello/style.scss&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;hello&#34;</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;|Hello, ${name}!|&#34;</span><span class="p">&gt;</span>Hello!<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;/vite/image/hello.png&#34;</span> <span class="p">/&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;module&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;/src/hello/main.ts&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>dev モードで起動し、挙動を確かめてみます。</p>
<pre tabindex="0"><code>npm run dev
</code></pre><p>を実行すると web サーバーが起動するのでブラウザーで http://localhost:5173/templates/hello/index.html にアクセスしてみます。scss が適用されていたり、(ブラウザーの devtools でコンソールを見てみると)TypeScript が実行されていたりするのが確認できたかと思います。</p>
<p>それでは、Spring Boot プロジェクトに出力してみます。</p>
<p><code>vite.config.ts</code> ファイルをひらき、 <code>build.input</code> 設定を次のように書き換えます:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">      <span class="nx">input</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ここに thymeleaf テンプレートファイルを列挙する
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;hello/index&#34;</span><span class="o">:</span> <span class="s2">&#34;templates/hello/index.html&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>そして次のコマンドでビルド&amp;配備を行います:</p>
<pre tabindex="0"><code>npm run build
</code></pre><p>これで Spring Boot プロジェクトの <code>src/main/resources</code> 以下にファイルがコピーされました。</p>
<p>最後に Spring Boot 側にコントローラーを作ります:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.stereotype.Controller</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.ui.Model</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Controller</span>
</span></span><span class="line"><span class="cl"><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s2">&#34;/hello&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HelloController</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@GetMapping</span>
</span></span><span class="line"><span class="cl">    <span class="k">fun</span> <span class="nf">index</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">):</span> <span class="n">String</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span><span class="p">.</span><span class="n">addAttribute</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">,</span> <span class="s2">&#34;Vite&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;hello/index&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>これで完成です。 Spring Boot を起動し、 http://localhost:8080/hello へアクセスしてみてください。</p>
<h2 id="実際に開発する上での追加設定">実際に開発する上での追加設定</h2>
<h3 id="gitignore-追加設定">.gitignore 追加設定</h3>
<p>Spring Boot の <code>src/main/resources/static/vite/</code>, <code>src/main/resources/templates/</code> には Vite が生成するファイルが置かれますので、このディレクトリ以下はバージョン管理対象外にします。<br />
具体的には、Spring Boot プロジェクトディレクトリルートの <code>.gitignore</code> に次の行を追記します:</p>
<pre tabindex="0"><code>/src/main/resources/static/vite/
/src/main/resources/templates/
</code></pre><h3 id="継続的ビルド">継続的ビルド</h3>
<p><code>thyemeleaf/package.json</code> の <code>script</code> 節に <code>watch</code> コマンドを追加します:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="err">...</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;scripts&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;watch&#34;</span><span class="p">:</span> <span class="s2">&#34;tsc &amp;&amp; vite build -w&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="err">...</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>thymeleaf</code> ディレクトリーで <code>npm run watch</code> を実行しておくと、ファイル変更があるたびにビルドが走り Spring Boot のプロジェクトファイルへ同期されるので、リアルタイムで変更が反映されます。</p>
<h3 id="既存のプロジェクトへ適用する場合の考慮">既存のプロジェクトへ適用する場合の考慮</h3>
<p>既に普通のやり方で <code>src/resources/templates</code> に Thymeleaf テンプレートファイルを作成している場合でも、基本的には今回の Vite で管理するようにする方法と同居できます。</p>
<p>ただし上記の設定だと Vite のビルド時に <code>src/resources/templates</code> を削除するようにしているので、この辺りの設定を見直す必要があります。</p>

        </section>
        <div class="post-tags">
          
          
          <nav class="nav tags">
            <ul class="tags">
              
              <li><a href="/tags/spring-boot">spring-boot</a></li>
              
              <li><a href="/tags/vite">vite</a></li>
              
              <li><a href="/tags/frontend">frontend</a></li>
              
            </ul>
          </nav>
          
          
        </div>
      </div>

      
      
    </div>

    </article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/yukihane" rel="me" title="GitHub"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github" />
</svg></a><a class="border"></a></div>
  <div class="footer-info">
    2025  &amp;copy;{year}, All Rights Reserved |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-E9J8FN5B4Q"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-E9J8FN5B4Q');
        }
      </script>

</div>
    </body>
</html>
