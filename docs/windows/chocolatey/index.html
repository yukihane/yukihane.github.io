<!DOCTYPE html>
<html><head lang="ja">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Chocolatey - 発火後忘失</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="
https://chocolatey.org/


インストール


PowerShell プロファイル作成

プロファイルが存在しない状態でChocolateyインストールを行うと警告が出て気持ち悪いので、プロファイルがなければ先に作成しておく。ただ、PowerShell2では挙動は変わらないようなので無視しても良さそう。
" />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="https://yukihane.github.io/docs/windows/chocolatey/">
  <meta property="og:site_name" content="発火後忘失">
  <meta property="og:title" content="Chocolatey">
  <meta property="og:description" content="https://chocolatey.org/
インストール PowerShell プロファイル作成 プロファイルが存在しない状態でChocolateyインストールを行うと警告が出て気持ち悪いので、プロファイルがなければ先に作成しておく。ただ、PowerShell2では挙動は変わらないようなので無視しても良さそう。">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2020-07-26T02:52:35+00:00">
    <meta property="article:modified_time" content="2020-07-26T02:52:35+00:00">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Chocolatey">
  <meta name="twitter:description" content="https://chocolatey.org/
インストール PowerShell プロファイル作成 プロファイルが存在しない状態でChocolateyインストールを行うと警告が出て気持ち悪いので、プロファイルがなければ先に作成しておく。ただ、PowerShell2では挙動は変わらないようなので無視しても良さそう。">

        <link href="https://yukihane.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://yukihane.github.io/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://yukihane.github.io/css/dark.50b57e12d401420df23965fed157368aba37b76df0ecefd0b1ecd4da664f01a0.css"  disabled />
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://yukihane.github.io/">発火後忘失</a>
	</div>
	<nav>
		
		<a href="/blog">Blog</a>
		
		<a href="/docs">Docs</a>
		
		<a href="/tags">Tags</a>
		
		<a href="https://github.com/yukihane/resume/blob/main/README.md">Resume</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#sun" />
</svg></span>
		<script src="https://yukihane.github.io/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
  <article>
    <div class="post-container">
      
      <div class="post-content">
        <div class="title">
          <h1 class="title">Chocolatey</h1>
          <div class="meta">Posted on 2020/07/26</div>
        </div>
        
        <section class="body">
          <div class="paragraph">
<p><a href="https://chocolatey.org/" class="bare">https://chocolatey.org/</a></p>
</div>
<div class="sect1">
<h2 id="_インストール">インストール</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="powershell_プロファイル作成">PowerShell プロファイル作成</h3>
<div class="paragraph">
<p>プロファイルが存在しない状態でChocolateyインストールを行うと警告が出て気持ち悪いので、プロファイルがなければ先に作成しておく。ただ、PowerShell2では挙動は変わらないようなので無視しても良さそう。</p>
</div>
<div class="paragraph">
<p>参考:
<a href="https://technet.microsoft.com/ja-jp/scriptcenter/powershell_owner06.aspx" class="bare">https://technet.microsoft.com/ja-jp/scriptcenter/powershell_owner06.aspx</a></p>
</div>
<div class="paragraph">
<p>PowerShellを起動し</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell">$profile</code></pre>
</div>
</div>
<div class="paragraph">
<p>を実行。これがプロファイル設定ファイルなので、ここにファイルが存在しなければファイルを作成する。</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/chocolatey/choco/issues/991">Not setting tab
completion · Issue #991 · chocolatey/choco</a>
によるとファイルサイズが4バイト以上無ければならないようなので、適当に数文字コメントを書いておく。このコメントはインストール後削除すれば良い。</p>
</div>
</div>
<div class="sect2">
<h3 id="chocolatey_インストール">Chocolatey インストール</h3>
<div class="paragraph">
<p>参考: <a href="https://chocolatey.org/install" class="bare">https://chocolatey.org/install</a></p>
</div>
<div class="paragraph">
<p>管理者権限無しでインストールする方法もあるようだが、以下では管理者権限でインストールする前提。
PowerShellやコマンドプロンプトを右クリックで「管理者として実行」メニューから実行し、その上でコマンドを叩く。</p>
</div>
<div class="paragraph">
<p>PowerShell3では冒頭に記載されているコマンドでインストールできるのだろうが、Windows7のPowerShell2では実行できなかった。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-winbatch" data-lang="winbatch">PS C:\Windows\system32&gt; iwr https://chocolatey.org/install.ps1 -UseBasicParsing | iex
用語 &#39;iwr&#39; は、コマンドレット、関数、スクリプト ファイル、または操作可能なプログラムの名前として認識されません。名前が
正しく記述されていることを確認し、パスが含まれている場合はそのパスが正しいことを確認してから、再試行してください。
発生場所 行:1 文字:4
+ iwr &lt;&lt;&lt;&lt;  https://chocolatey.org/install.ps1 -UseBasicParsing | iex
    + CategoryInfo          : ObjectNotFound: (iwr:String) []、CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException</code></pre>
</div>
</div>
<div class="paragraph">
<p>代わりに、https://chocolatey.org/install#alternative-installation-options[Alternative
Installation Options]のCommand Lineに書いてある方法を採用。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-winbatch" data-lang="winbatch">C:\Windows\system32&gt;@powershell -NoProfile -ExecutionPolicy unrestricted -Command &#34;(iex ((new-object net.webclient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;))) &gt;$null 2&gt;&amp;1&#34; &amp;&amp; SET PATH=&#34;%PATH%;%ALLUSERSPROFILE%\chocolatey\bin&#34;
WARNING: It&#39;s very likely you will need to close and reopen your shell
  before you can use choco.
WARNING: You can safely ignore errors related to missing log files when
  upgrading from a version of Chocolatey less than 0.9.9.
  &#39;Batch file could not be found&#39; is also safe to ignore.
  &#39;The system cannot find the file specified&#39; - also safe.
PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
WARNING: Chocolatey profile installed. Reload your profile - type . $profile
WARNING: Tab completion does not currently work in PowerShell v2.
 Please upgrade to a more recent version of PowerShell to take advantage of tab completion.</code></pre>
</div>
</div>
<div class="paragraph">
<p>幾つか警告が出ているがインストールされた模様。
環境変数 <code>ChocolateyInstall</code> にインストール先(デフォルトでは <code>C:\ProgramData\chocolatey</code> )が設定されたりしている。</p>
</div>
<div class="paragraph">
<p>インストール後、コマンドプロンプトを新しく起動し、 <code>choco</code> コマンドを実行してバージョンが出力されればOKだと思われる。</p>
</div>
</div>
<div class="sect2">
<h3 id="補足_プロファイル設定ファイルがなかった場合">補足: プロファイル設定ファイルがなかった場合</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-winbatch" data-lang="winbatch">C:\Windows\system32&gt;@powershell -NoProfile -ExecutionPolicy unrestricted -Command &#34;(iex ((new-object net.webclient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;))) &gt;$null 2&gt;&amp;1&#34; &amp;&amp; SET PATH=&#34;%PATH%;%ALLUSERSPROFILE%\chocolatey\bin&#34;
WARNING: It&#39;s very likely you will need to close and reopen your shell
  before you can use choco.
WARNING: You can safely ignore errors related to missing log files when
  upgrading from a version of Chocolatey less than 0.9.9.
  &#39;Batch file could not be found&#39; is also safe to ignore.
  &#39;The system cannot find the file specified&#39; - also safe.
PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
警告: Not setting tab completion: Profile file does not exist at
&#39;C:\Users\xxx\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1&#39;.</code></pre>
</div>
</div>
<div class="paragraph">
<p>インストール後、次の内容が <code>$profile</code> ファイルに追記されるので、もしインストール時にこのような警告を受け取っても、後から手で編集すればよいだろう。
なお、先に示した設定ファイルが存在する場合のインストールログから分かる通り、いずれにせよWindows7のPowerShell2では補完は機能しない模様。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell"># Chocolatey profile
$ChocolateyProfile = &#34;$env:ChocolateyInstall\helpers\chocolateyProfile.psm1&#34;
if (Test-Path($ChocolateyProfile)) {
  Import-Module &#34;$ChocolateyProfile&#34;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_アンインストール">アンインストール</h2>
<div class="sectionbody">
<div class="paragraph">
<p>参考: <a href="https://chocolatey.org/docs/uninstallation" class="bare">https://chocolatey.org/docs/uninstallation</a></p>
</div>
<div class="paragraph">
<p>アンインストールスクリプトもあるようだが、手動で行うことにする。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>インストールディレクトリ: <code>C:\ProgramData\chocolatey</code> を削除する.</p>
</li>
<li>
<p>環境変数: <code>ChocolateyInstall</code>, <code>ChocolateyBinRoot</code>,
`ChocolateyToolsLocation`を削除する. また,
`PATH`にもchocolateyのものが含まれているので削る。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>なお当方の環境では、環境変数は <code>ChocolateyInstall</code> しか存在しなかった。</p>
</div>
<div class="paragraph">
<p>古いバージョンではインストールディレクトリが異なっていたりするようなので、正確な情報は先に示したURLを参照するのが良い。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="パッケージ_インストール">パッケージ インストール</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ここではpython(Python3)をインストールしてみる。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-winbatch" data-lang="winbatch">C:\Windows\system32&gt;cinst python
Chocolatey v0.10.3
Installing the following packages:
python
By installing you accept licenses for the packages.

python3 v3.6.0 [Approved]
python3 package files install completed. Performing other installation steps.
The package python3 wants to run &#39;chocolateyInstall.ps1&#39;.
Note: If you don&#39;t run this script, the installation will fail.
Note: To confirm automatically next time, use &#39;-y&#39; or consider setting
 &#39;allowGlobalConfirmation&#39;. Run &#39;choco feature -h&#39; for more details.
Do you want to run the script?([Y]es/[N]o/[P]rint): y

Using system proxy server &#39;[xxxx]&#39;.
Downloading python3 64 bit
  from &#39;https://www.python.org/ftp/python/3.6.0/python-3.6.0-amd64.exe&#39;
Using system proxy server &#39;xxxx&#39;.
Progress: 100% - Completed download of C:\Users\xxx\AppData\Local\Temp\chocolatey\python3\3.6.0\python-3.6.0-amd64.exe
(30.05 MB).
Download of python-3.6.0-amd64.exe (30.05 MB) completed.
Hashes match.
Installing python3...
python3 has been installed.
Installed to &#39;C:\Python36&#39;
Environment Vars (like PATH) have changed. Close/reopen your shell to
 see the changes (or in powershell/cmd.exe just type `refreshenv`).
 The install of python3 was successful.
  Software installed as &#39;EXE&#39;, install location is likely default.

python v3.6.0 [Approved]
python package files install completed. Performing other installation steps.
 The install of python was successful.
  Software install location not explicitly set, could be in package or
  default install location if installer.

Chocolatey installed 2/2 packages. 0 packages failed.
 See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).</code></pre>
</div>
</div>
<div class="paragraph">
<p>新しく(一般権限で)コマンドプロンプトを起動し <code>python --version</code> を打ってみるとインストールされているのが確認できる。</p>
</div>
<div class="paragraph">
<p>本題とは外れるが、上記インストールログ中に <code>refreshenv</code> コマンドというものが登場するので、インストールした直後のコマンドプロンプトで挙動を確認しておく。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-winbatch" data-lang="winbatch">C:\Windows\system32&gt;python --version
&#39;python&#39; は、内部コマンドまたは外部コマンド、
操作可能なプログラムまたはバッチ ファイルとして認識されていません。

C:\Windows\system32&gt;refreshenv
Refreshing environment variables from registry for cmd.exe. Please wait...Finished..

C:\Windows\system32&gt;python --version
Python 3.6.0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="パッケージ_アンインストール">パッケージ アンインストール</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>python</code> パッケージをインストールすると、 <code>python</code>, <code>python3</code> パッケージがインストールされるので、両方アンインストールする必要がある。</p>
</div>
<div class="paragraph">
<p>現在インストールされているパッケージ一覧は <code>choco version all</code> で参照できる。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-winbatch" data-lang="winbatch">C:\Windows\system32&gt;choco version all
Chocolatey v0.10.3

DEPRECATION NOTICE - choco version command is deprecated and will be
 removed in version 1.0.0. Please use `choco upgrade pgkname --noop`
 instead.
_ Chocolatey:ChocolateyVersionCommand - Noop Mode _
chocolatey v0.10.3 is the latest version available based on your source(s).
python v3.6.0 is the latest version available based on your source(s).
python3 v3.6.0 is the latest version available based on your source(s).</code></pre>
</div>
</div>
<div class="paragraph">
<p>アンインストールを実行。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-winbatch" data-lang="winbatch">C:\Windows\system32&gt;cuninst python
Chocolatey v0.10.3
Uninstalling the following packages:
python

python v3.6.0
 Skipping auto uninstaller - No registry snapshot.
 python has been successfully uninstalled.

Chocolatey uninstalled 1/1 packages. 0 packages failed.
 See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
C:\Windows\system32&gt;cuninst python3
Chocolatey v0.10.3
Uninstalling the following packages:
python3

python3 v3.6.0
 Running auto uninstaller...
 Auto uninstaller has successfully uninstalled python3 or detected previous uninstall.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Skipping auto uninstaller - The application appears to have been uninstalled already by other means.
 Auto uninstaller has successfully uninstalled python3 or detected previous uninstall.
 python3 has been successfully uninstalled.
Environment Vars (like PATH) have changed. Close/reopen your shell to
 see the changes (or in powershell/cmd.exe just type `refreshenv`).

Chocolatey uninstalled 1/1 packages. 0 packages failed.
 See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).</code></pre>
</div>
</div>
<div class="paragraph">
<p>インストール時に環境変数 <code>PATH</code> にPython関係のものがいくつか追加されていたようだが、このアンインストール手順では削除されない。手動で行う必要がある。</p>
</div>
</div>
</div>

        </section>
        <div class="post-tags">
          
          
          
        </div>
      </div>

      
      
    </div>

    </article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/yukihane" rel="me" title="GitHub"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github" />
</svg></a><a class="border"></a></div>
  <div class="footer-info">
    2025  &amp;copy;{year}, All Rights Reserved |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-E9J8FN5B4Q"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-E9J8FN5B4Q');
        }
      </script>

</div>
    </body>
</html>
